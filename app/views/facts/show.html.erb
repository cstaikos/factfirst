<span id="alert"></span>
<div>
  <p>
    <strong><%= User.find(@fact.user_id).display_name %></strong> posted this fact!
  </p>

  <p>
    <%= @fact.body %> - Truthiness score: <h1><%= @fact.score %></h1>
  </p>
</div>

<div class="evidence">
  <h2><%= pluralize @fact.supporting_evidence.count, 'piece' %> of supporting evidence:</h2>
  <ul>
    <% @fact.supporting_evidence.each do |evidence| %>
      <li>
        <h4><%= evidence.url%></h4>
        <p>Posted by <%= evidence.user.display_name %></p>
        <p>
          <!--NOTE: Refactor using helpers-->
          <%= link_to "#{pluralize evidence.upvotes, 'upvote'}",
                      votes_path(vote: {evidence_id: evidence.id, upvote: true}),
                      method: :post,
                      remote: current_user != nil,
                      id: "upvote_#{evidence.id}" %>

        | <%= link_to "#{pluralize evidence.downvotes, 'downvote'}",
                      votes_path(vote: {evidence_id: evidence.id, upvote: false}),
                      method: :post,
                      remote: current_user != nil,
                      id: "downvote_#{evidence.id}" %>
        </p>
      </li>
    <% end %>
  </ul>
  <div>
    <h4>Add supporting evidence:</h4>
    <%= form_for [@fact, @evidence] do |f| %>
      <div>
        <%= f.label :url %>
        <%= f.url_field :url %>
      </div>

      <%= f.hidden_field :support, value: true %>

      <div>
        <%= f.submit %>
      </div>
    <% end %>
  </div>
</div>

<div class="evidence">
  <h2><%= pluralize @fact.refuting_evidence.count, 'piece' %> of refuting evidence:</h2>
  <ul>
    <% @fact.refuting_evidence.each do |evidence| %>
      <li>
        <h4><%= evidence.url%></h4>
        <p>Posted by <%= evidence.user.display_name %></p>

        <p>
          <!--NOTE: Refactor using helpers-->
          <%= link_to "#{pluralize evidence.upvotes, 'upvote'}",
                      votes_path(vote: {evidence_id: evidence.id, upvote: true}),
                      method: :post,
                      remote: current_user != nil,
                      id: "upvote_#{evidence.id}" %>

        | <%= link_to "#{pluralize evidence.downvotes, 'downvote'}",
                      votes_path(vote: {evidence_id: evidence.id, upvote: false}),
                      method: :post,
                      remote: current_user != nil,
                      id: "downvote_#{evidence.id}" %>
        </p>
      </li>
    <% end %>
  </ul>
  <div>
    <h4>Add refuting evidence:</h4>
    <%= form_for [@fact, @evidence] do |f| %>
      <div>
        <%= f.label :url %>
        <%= f.url_field :url %>
      </div>

      <%= f.hidden_field :support, value: false %>

      <div>
        <%= f.submit %>
      </div>
    <% end %>
  </div>
</div>





<% if current_user == User.find(@fact.user_id)  %>
  <%= link_to "Delete Fact", fact_path(@fact), method: :delete, date: {confirm:"Are you sure you want to delete this
  fact?"} %>
<% end  %>


<div style="clear:both;">
  <p>
    <strong>
      Share a permalink image of this fact on another site: <%= root_url[0..-2] + asset_path("fact_photos/#{@fact.id}.png") %>
    </strong>
  </p>
  <%= image_tag "fact_photos/#{@fact.id}.png", width: 400 %>
</div>
